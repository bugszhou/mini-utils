{"version":3,"file":"miniapp-utils.esm.js","sources":["../src/lib/core/getGlobal.js","../src/lib/core/platform.js","../src/lib/utils/showModal.js","../src/lib/core/updateApp.js"],"sourcesContent":["\nexport default function() {\n  if (typeof wx !== 'undefined' && wx) {\n    return wx;\n  }\n  if (typeof my !== 'undefined' && my) {\n    return my;\n  }\n  if (typeof swan !== 'undefined' && swan) {\n    return swan;\n  }\n  if (typeof tt !== 'undefined' && tt) {\n    return tt;\n  }\n  return global;\n}","\nexport default function getPlatform() {\n  if (typeof wx !== 'undefined' && wx) {\n    return \"weapp\";\n  }\n  if (typeof my !== 'undefined' && my) {\n    return \"aliapp\";\n  }\n  if (typeof swan !== 'undefined' && swan) {\n    return \"swan\";\n  }\n  if (typeof tt !== 'undefined' && tt) {\n    return \"tt\";\n  }\n  throw new Error(`Not Support In This Platform!`);\n}","import getPlatform from '../core/platform';\nimport getGlobal from '../core/getGlobal';\n\nexport default function showModal(opts = {}) {\n  const platform = getPlatform();\n  if (platform === \"aliapp\") {\n    return getGlobal().confirm(opts);\n  }\n  return getGlobal().showModal(opts);\n}\n","import getGlobal from './getGlobal';\nimport showModal from '../utils/showModal';\n\nconst globalObj = getGlobal();\n\nexport default function updateApp({ reLaunchPage } = { reLaunch: '/pages/index/index' }) {\n  const updateManager = globalObj.getUpdateManager();\n\n  updateManager.onCheckForUpdate((res) => {\n    // 是否有更新\n    console.log(res.hasUpdate);\n  });\n\n  updateManager.onUpdateReady(() => {\n    showModal({\n      title: '更新提示',\n      content: '新版本已经准备好，是否重启应用？',\n      showCancel: false,\n      confirmText: '使用新版',\n      success() {\n        updateManager.applyUpdate();\n      },\n    });\n  });\n\n  updateManager.onUpdateFailed(() => {\n    // 新版本下载失败\n    globalObj.reLaunch({ url: reLaunchPage });\n  });\n\n  return updateManager;\n}"],"names":["wx","my","swan","tt","global","getPlatform","Error","showModal","opts","platform","getGlobal","confirm","globalObj","updateApp","reLaunch","reLaunchPage","updateManager","getUpdateManager","onCheckForUpdate","res","console","log","hasUpdate","onUpdateReady","title","content","showCancel","confirmText","success","applyUpdate","onUpdateFailed","url"],"mappings":"oBAC0B,QACN,WAAd,SAAOA,EAAP,EAA6BA,EADT,CAEfA,EAFe,CAIN,WAAd,SAAOC,EAAP,EAA6BA,EAJT,CAKfA,EALe,CAOJ,WAAhB,SAAOC,IAAP,EAA+BA,IAPX,CAQfA,IARe,CAUN,WAAd,SAAOC,EAAP,EAA6BA,EAVT,CAWfA,EAXe,CAajBC,MACR;;SCduBC,WAAT,EAAuB,CACpC,GAAkB,WAAd,SAAOL,EAAP,EAA6BA,EAAjC,CACE,OAAO,OAAP,CAEF,GAAkB,WAAd,SAAOC,EAAP,EAA6BA,EAAjC,CACE,OAAO,QAAP,CAEF,GAAoB,WAAhB,SAAOC,IAAP,EAA+BA,IAAnC,CACE,OAAO,MAAP,CAEF,GAAkB,WAAd,SAAOC,EAAP,EAA6BA,EAAjC,CACE,OAAO,IAAP,CAEF,UAAUG,KAAJ,iCACP;;SCZuBC,SAAT,EAA8B,KAAXC,IAAW,wDAAJ,EAAI,CACrCC,QAAQ,CAAGJ,WAAW,EADe,QAE1B,QAAb,GAAAI,QAFuC,CAGlCC,SAAS,GAAGC,OAAZ,CAAoBH,IAApB,CAHkC,CAKpCE,SAAS,GAAGH,SAAZ,CAAsBC,IAAtB,CACR;;ACND,IAAMI,SAAS,CAAGF,SAAS,EAA3B,CAEA,SAAwBG,SAAT,EAA0E,iEAApC,CAAEC,QAAQ,CAAE,oBAAZ,CAAoC,CAArDC,YAAqD,MAArDA,YAAqD,CACjFC,aAAa,CAAGJ,SAAS,CAACK,gBAAV,EADiE,CAyBvF,OAtBAD,aAAa,CAACE,gBAAd,CAA+B,SAACC,GAAD,CAAS,CAEtCC,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,SAAhB,EACD,CAHD,CAsBA,CAjBAN,aAAa,CAACO,aAAd,CAA4B,UAAM,CAChChB,SAAS,CAAC,CACRiB,KAAK,CAAE,0BADC,CAERC,OAAO,CAAE,kGAFD,CAGRC,UAAU,GAHF,CAIRC,WAAW,CAAE,0BAJL,CAKRC,OALQ,mBAKE,CACRZ,aAAa,CAACa,WAAd,GACD,CAPO,CAAD,EASV,CAVD,CAiBA,CALAb,aAAa,CAACc,cAAd,CAA6B,UAAM,CAEjClB,SAAS,CAACE,QAAV,CAAmB,CAAEiB,GAAG,CAAEhB,YAAP,CAAnB,EACD,CAHD,CAKA,CAAOC,aACR;;;;"}