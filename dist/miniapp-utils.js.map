{"version":3,"file":"miniapp-utils.js","sources":["../src/lib/core/getGlobal.js","../src/lib/core/updateApp.js"],"sourcesContent":["export default function() {\n  return wx || my || swan || tt || global;\n}","import getGlobal from './getGlobal';\n\nconst globalObj = getGlobal();\n\nexport default function updateApp({ reLaunchPage } = { reLaunch: '/pages/index/index' }) {\n  const updateManager = globalObj.getUpdateManager();\n\n  updateManager.onCheckForUpdate((res) => {\n    // 是否有更新\n    console.log(res.hasUpdate);\n  });\n\n  updateManager.onUpdateReady(() => {\n    globalObj.showModal({\n      title: '更新提示',\n      content: '新版本已经准备好，是否重启应用？',\n      showCancel: false,\n      confirmText: '使用新版本',\n      success() {\n        updateManager.applyUpdate();\n      },\n    });\n  });\n\n  updateManager.onUpdateFailed(() => {\n    // 新版本下载失败\n    globalObj.reLaunch({ url: reLaunchPage });\n  });\n\n  return updateManager;\n}"],"names":["wx","my","swan","tt","global","globalObj","getGlobal","updateApp","reLaunch","reLaunchPage","updateManager","getUpdateManager","onCheckForUpdate","res","console","log","hasUpdate","onUpdateReady","showModal","title","content","showCancel","confirmText","success","applyUpdate","onUpdateFailed","url"],"mappings":";;;;;;;;;;;EAAe,sBAAW;EACxB,SAAOA,EAAE,IAAIC,EAAN,IAAYC,IAAZ,IAAoBC,EAApB,IAA0BC,MAAjC;EACD;;ECAD,IAAMC,SAAS,GAAGC,SAAS,EAA3B;AAEA,EAAe,SAASC,SAAT,GAA0E;EAAA,iFAApC;EAAEC,IAAAA,QAAQ,EAAE;EAAZ,GAAoC;EAAA,MAArDC,YAAqD,QAArDA,YAAqD;;EACvF,MAAMC,aAAa,GAAGL,SAAS,CAACM,gBAAV,EAAtB;EAEAD,EAAAA,aAAa,CAACE,gBAAd,CAA+B,UAACC,GAAD,EAAS;EAEtCC,IAAAA,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,SAAhB;EACD,GAHD;EAKAN,EAAAA,aAAa,CAACO,aAAd,CAA4B,YAAM;EAChCZ,IAAAA,SAAS,CAACa,SAAV,CAAoB;EAClBC,MAAAA,KAAK,EAAE,MADW;EAElBC,MAAAA,OAAO,EAAE,kBAFS;EAGlBC,MAAAA,UAAU,EAAE,KAHM;EAIlBC,MAAAA,WAAW,EAAE,OAJK;EAKlBC,MAAAA,OALkB,qBAKR;EACRb,QAAAA,aAAa,CAACc,WAAd;EACD;EAPiB,KAApB;EASD,GAVD;EAYAd,EAAAA,aAAa,CAACe,cAAd,CAA6B,YAAM;EAEjCpB,IAAAA,SAAS,CAACG,QAAV,CAAmB;EAAEkB,MAAAA,GAAG,EAAEjB;EAAP,KAAnB;EACD,GAHD;EAKA,SAAOC,aAAP;EACD;;;;;;;;;;;;;"}