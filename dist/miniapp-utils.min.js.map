{"version":3,"file":"miniapp-utils.min.js","sources":["../src/lib/core/getGlobal.js","../src/lib/core/platform.js","../src/lib/core/updateApp.js","../src/lib/utils/showModal.js"],"sourcesContent":["\nexport default function() {\n  if (typeof wx !== 'undefined' && wx) {\n    return wx;\n  }\n  if (typeof my !== 'undefined' && my) {\n    return my;\n  }\n  if (typeof swan !== 'undefined' && swan) {\n    return swan;\n  }\n  if (typeof tt !== 'undefined' && tt) {\n    return tt;\n  }\n  return global;\n}","\nexport default function getPlatform() {\n  if (typeof wx !== 'undefined' && wx) {\n    return \"weapp\";\n  }\n  if (typeof my !== 'undefined' && my) {\n    return \"aliapp\";\n  }\n  if (typeof swan !== 'undefined' && swan) {\n    return \"swan\";\n  }\n  if (typeof tt !== 'undefined' && tt) {\n    return \"tt\";\n  }\n  throw new Error(`Not Support In This Platform!`);\n}","import getGlobal from './getGlobal';\nimport showModal from '../utils/showModal';\n\nconst globalObj = getGlobal();\n\nexport default function updateApp({ reLaunchPage } = { reLaunch: '/pages/index/index' }) {\n  const updateManager = globalObj.getUpdateManager();\n\n  updateManager.onCheckForUpdate((res) => {\n    // 是否有更新\n    console.log(res.hasUpdate);\n  });\n\n  updateManager.onUpdateReady(() => {\n    showModal({\n      title: '更新提示',\n      content: '新版本已经准备好，是否重启应用？',\n      showCancel: false,\n      confirmText: '使用新版',\n      success() {\n        updateManager.applyUpdate();\n      },\n    });\n  });\n\n  updateManager.onUpdateFailed(() => {\n    // 新版本下载失败\n    globalObj.reLaunch({ url: reLaunchPage });\n  });\n\n  return updateManager;\n}","import getPlatform from '../core/platform';\nimport getGlobal from '../core/getGlobal';\n\nexport default function showModal() {\n  const platform = getPlatform();\n  if (platform === \"aliapp\") {\n    return getGlobal().alert;\n  }\n  return getGlobal().showModal;\n}\n"],"names":["wx","my","swan","tt","global","getPlatform","Error","globalObj","getGlobal","reLaunchPage","reLaunch","updateManager","getUpdateManager","onCheckForUpdate","res","console","log","hasUpdate","onUpdateReady","alert","showModal","onUpdateFailed","url"],"mappings":"oUAEoB,oBAAPA,IAAsBA,GACxBA,GAES,oBAAPC,IAAsBA,GACxBA,GAEW,oBAATC,MAAwBA,KAC1BA,KAES,oBAAPC,IAAsBA,GACxBA,GAEFC,gBCbeC,IACtB,GAAkB,oBAAPL,IAAsBA,GAC/B,MAAO,QAET,GAAkB,oBAAPC,IAAsBA,GAC/B,MAAO,SAET,GAAoB,oBAATC,MAAwBA,KACjC,MAAO,OAET,GAAkB,oBAAPC,IAAsBA,GAC/B,MAAO,KAET,UAAUG,2CCXNC,EAAYC,6DAEkBC,0DAAiB,CAAEC,SAAU,uBAA7BD,aAC5BE,EAAgBJ,EAAUK,mBAwBhC,OAtBAD,EAAcE,iBAAiB,SAACC,GAE9BC,QAAQC,IAAIF,EAAIG,aAGlBN,EAAcO,cAAc,WCRX,WADAb,IAERG,IAAYW,MAEdX,IAAYY,YDiBnBT,EAAcU,eAAe,WAE3Bd,EAAUG,SAAS,CAAEY,IAAKb,MAGrBE"}